<!DOCTYPE html>
<html lang="{{ site.lang }}">

{% include head.html %}

  <script>
    var [lang, locale] = (((navigator.userLanguage || navigator.language).replace('-', '_')).toLowerCase()).split('_');

    function getBestSuitableSupportedLang(lang, locale, supported) {
      // Exclude first element, default language
      var supported_lang = supported.shift();

      if (supported.includes(lang + "-" + locale)) {
        supported_lang = lang + "-" + locale;
      } else if (supported.includes(lang)) {
        supported_lang = lang;
      }

      return supported_lang;
    }

    var supported_languages = {{ site.languages | jsonify }};
    var current_lang = '{{ site.lang }}';

    var suitable_lang = getBestSuitableSupportedLang(lang, locale, supported_languages)

    var hostname = window.location.hostname;
    var referrer = document.referrer;

    var landingPage = !referrer || referrer.indexOf(hostname) == -1;
    console.log('Referrer: ', document.referrer);
    console.log('Landing page ? ', landingPage);

    // /!\ Need to force lang if user select, even if not best fit

    if (landingPage && (current_lang !== suitable_lang)) {
      window.location = '/' + suitable_lang + '/';
    }
  </script>

  <body>
    <!-- Hero(extended) navbar -->
    <div class="navbar navbar--extended">
      <nav class="nav__mobile"></nav>
      <div class="container">
        {% include navbar-inner.html %}
      </div>
    </div>

    {{ content }}

    {% include footer-dark.html %}

    {% include scripts.html %}
  </body>

</html>